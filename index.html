<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>F&O Options Calculator</title>
  <!-- Materialize CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    html, body {
      padding: 0;
      margin: 0;
      background: #f8fafb;
      font-size: 14px;
    }
    .compact-card {
      max-width: 340px;
      margin: 24px auto 8px auto;
      padding: 12px 16px 2px 16px;
      border-radius: 10px;
      box-shadow: 0 2px 6px #e0e0e0;
    }
    .calc-row {
      display: flex;
      gap:8px;
      margin-bottom: 8px;
    }
    .calc-row .input-field {
      margin: 0;
      flex: 1;
    }
    .exchange-row {
      margin: 0 0 8px 0;
      padding: 0;
    }
    .results-table {
      font-size: 13px;
      width: 100%;
      margin-bottom: 0;
    }
    .results-table td {
      padding: 2px 0 2px 0;
    }
    .green-text {
      color: #26a69a !important;
    }
    .divider {
      margin-top: 6px;
      margin-bottom: 8px;
    }
    .card-title {
      font-size: 18px;
      text-align: center;
      color: #1976d2;
      font-weight: 700;
      margin: 2px 0 4px 0;
    }
  </style>
</head>
<body>
  <div class="card compact-card white">
    <div class="card-title">F&O - Options</div>
    <form id="calculatorForm" autocomplete="off">
      <div class="calc-row">
        <div class="input-field">
          <input id="buy" type="number" value="500" min="0"/>
          <label for="buy" class="active">Buy</label>
        </div>
        <div class="input-field">
          <input id="sell" type="number" value="510" min="0"/>
          <label for="sell" class="active">Sell</label>
        </div>
        <div class="input-field">
          <input id="qty" type="number" value="20" min="1"/>
          <label for="qty" class="active">Qty</label>
        </div>
      </div>
      <div class="exchange-row">
        <label style="margin-right:12px;">Exchange:</label>
        <label style="margin-right:8px;">
          <input name="exchange" type="radio" value="NSE" id="nseRadio"/>
          <span style="padding-right:8px;">NSE</span>
        </label>
        <label>
          <input name="exchange" type="radio" value="BSE" id="bseRadio" checked />
          <span>BSE</span>
        </label>
      </div>
    </form>
    <div class="divider"></div>
    <table class="results-table" id="results">
      <!-- Results fill here -->
    </table>
  </div>
  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    function calculate() {
      const buy = parseFloat(document.getElementById('buy').value) || 0;
      const sell = parseFloat(document.getElementById('sell').value) || 0;
      const qty = parseInt(document.getElementById('qty').value) || 0;
      const exchange = document.getElementById('nseRadio').checked ? 'NSE' : 'BSE';
      // Rates
      const txnChargePct = exchange === 'BSE' ? 0.00033 : 0.00053;
      const stampPct = 0.00003;
      const ipftPct = 0.000001;
      const sebiPct = 0.00001;
      const gstPct = 0.18;
      const brokerage = 0;
      const clearingCharge = 0;
      // Calculations
      const turnover   = (buy + sell) * qty;
      const stt        = sell * qty * 0.0005;
      const exchTxn    = turnover * txnChargePct;
      const gst        = (brokerage + exchTxn + clearingCharge) * gstPct;
      const ipft       = turnover * ipftPct;
      const sebi       = turnover * sebiPct;
      const stampDuty  = buy * qty * stampPct;
      const totalTax   = stt + exchTxn + clearingCharge + gst + ipft + sebi + stampDuty;
      const breakeven  = qty === 0 ? 0 : totalTax / qty;
      const netPL      = (sell - buy) * qty - totalTax;
      return {
        turnover, brokerage, stt, exchTxn, clearingCharge,
        gst, ipft, sebi, stampDuty, totalTax, breakeven, netPL
      };
    }

    function updateResults() {
      const r = calculate();
      const format = n => n.toFixed(2);
      document.getElementById('results').innerHTML = `
        <tr><td>Turnover</td><td>${format(r.turnover)}</td></tr>
        <tr><td>Brokerage</td><td>${format(r.brokerage)}</td></tr>
        <tr><td>STT total</td><td>${format(r.stt)}</td></tr>
        <tr><td>Exchange txn charge</td><td>${format(r.exchTxn)}</td></tr>
        <tr><td>Clearing charge</td><td>${format(r.clearingCharge)}</td></tr>
        <tr><td>GST</td><td>${format(r.gst)}</td></tr>
        <tr><td>IPFT charges</td><td>${format(r.ipft)}</td></tr>
        <tr><td>SEBI charges</td><td>${format(r.sebi)}</td></tr>
        <tr><td>Stamp duty</td><td>${format(r.stampDuty)}</td></tr>
        <tr style="font-weight:600;"><td>Total tax &amp; charges</td><td>${format(r.totalTax)}</td></tr>
        <tr><td>Points to breakeven</td><td>${format(r.breakeven)}</td></tr>
        <tr style="font-weight:700"><td>Net P&amp;L</td><td class="green-text">${format(r.netPL)}</td></tr>
      `;
    }

    document.getElementById('calculatorForm').addEventListener('input', updateResults);
    document.addEventListener('DOMContentLoaded', function() {
      M.updateTextFields();
      updateResults();
    });
  </script>
</body>
</html>
